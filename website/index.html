<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Campus Point - Sistem poin kampus berbasis blockchain">
    <title>Campus Point | Blockchain-Based Campus Reward System</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container no-sidebar">
        <!-- Top Navigation Bar -->
        <header class="top-nav">
            <div class="top-nav-left">
                <div class="logo">
                    <span class="logo-icon">â—†</span>
                    <span class="logo-text">Campus Point</span>
                </div>
            </div>
            <nav class="top-nav-center">
                <a href="#dashboard" class="nav-tab active" data-page="dashboard">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span>Dashboard</span>
                </a>
                <a href="#activities" class="nav-tab student-only" data-page="activities">
                    <span class="nav-icon">ğŸ“‹</span>
                    <span>Kegiatan</span>
                </a>
                <a href="#certificates" class="nav-tab student-only" data-page="certificates">
                    <span class="nav-icon">ğŸ–ï¸</span>
                    <span>Sertifikat</span>
                </a>
                <a href="#admin" class="nav-tab admin-only" data-page="admin">
                    <span class="nav-icon">âš™ï¸</span>
                    <span>Admin Panel</span>
                </a>
            </nav>
            <div class="top-nav-right">
                <button class="btn btn-primary" id="connectWallet">
                    <span class="btn-icon">ğŸ”—</span>
                    <span id="walletButtonText">Connect Wallet</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content full-width">
            <!-- Page Content Container -->
            <div class="page-container" id="pageContainer">
                <!-- Dashboard Page -->
                <div class="page active" id="dashboardPage">
                    <div class="welcome-section">
                        <h2>Selamat Datang di Campus Point</h2>
                        <p>Sistem reward berbasis blockchain untuk kegiatan kampus Anda</p>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-info">
                                <span class="stat-label">Total Points</span>
                                <span class="stat-value" id="pointBalance">0</span>
                                <span class="stat-change">CPNT Balance</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-info">
                                <span class="stat-label">Certificates Owned</span>
                                <span class="stat-value" id="certCount">0</span>
                                <span class="stat-change">NFT Sertifikat</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-info">
                                <span class="stat-label">Active Events</span>
                                <span class="stat-value" id="activityCount">0</span>
                                <span class="stat-change">Kegiatan Berlangsung</span>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-row">
                        <div class="recent-section">
                            <h3>Aktivitas Terbaru</h3>
                            <div class="activity-list" id="recentActivity">
                                <div class="empty-state">
                                    <p>Belum ada aktivitas. Hubungkan wallet untuk melihat data Anda.</p>
                                </div>
                            </div>
                        </div>
                        <div class="recent-section">
                            <h3>ğŸ’° Poin Terbaru</h3>
                            <div class="activity-list" id="recentPoints">
                                <div class="empty-state">
                                    <p>Belum ada poin yang diterima.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Activities Page -->
                <div class="page" id="activitiesPage">
                    <div class="page-header">
                        <h2>Daftar Kegiatan Kampus</h2>
                        <p>Ikuti kegiatan dan dapatkan poin CPNT</p>
                    </div>
                    <div class="activities-grid" id="activitiesList">
                        <div class="empty-state">
                            <p>Memuat kegiatan...</p>
                        </div>
                    </div>
                </div>

                <!-- Certificates Page -->
                <div class="page" id="certificatesPage">
                    <div class="page-header">
                        <h2>Koleksi Sertifikat NFT</h2>
                        <p>Sertifikat digital Anda yang tersimpan di blockchain</p>
                    </div>
                    <div class="certificates-grid" id="certificatesList">
                        <div class="empty-state">
                            <p>Belum ada sertifikat. Hubungkan wallet untuk melihat koleksi Anda.</p>
                        </div>
                    </div>

                    <!-- Request Certificate Form (for students) -->
                    <div class="request-cert-section" id="requestCertSection">
                        <div class="page-header">
                            <h3>ğŸ“ Ajukan Sertifikat</h3>
                            <p>Ajukan klaim sertifikat untuk kegiatan yang pernah Anda ikuti</p>
                        </div>
                        <form id="requestCertForm" class="form request-cert-form">
                            <div class="form-group">
                                <label for="reqEventName">Nama Kegiatan/Event</label>
                                <input type="text" id="reqEventName" placeholder="Contoh: Seminar Web3" required>
                            </div>
                            <div class="form-group">
                                <label for="reqIpfsUri">IPFS URI (Metadata Sertifikat)</label>
                                <input type="text" id="reqIpfsUri" placeholder="ipfs://Qm..." required>
                                <small>Upload metadata sertifikat Anda ke IPFS terlebih dahulu</small>
                            </div>
                            <button type="submit" class="btn btn-primary">Ajukan Sertifikat</button>
                        </form>
                    </div>
                </div>

                <!-- Admin Page -->
                <div class="page" id="adminPage">
                    <div class="page-header centered">
                        <h2>Panel Admin</h2>
                        <p>Kelola kegiatan, reward, dan sertifikat</p>
                    </div>

                    <!-- Admin Tabs -->
                    <div class="admin-tabs">
                        <button class="admin-tab active" data-tab="adminKegiatan">ğŸ“‹ Kegiatan</button>
                        <button class="admin-tab" data-tab="adminPengajuan">ğŸ“© Pengajuan</button>
                        <button class="admin-tab" data-tab="adminSertifikat">ğŸ–ï¸ Semua Sertifikat</button>
                    </div>

                    <!-- Tab Contents -->
                    <div class="admin-tab-contents">
                        <!-- Kegiatan Tab -->
                        <div class="admin-tab-content active" id="adminKegiatan">
                            <div class="admin-sections">
                                <!-- Daftar Kegiatan -->
                                <div class="admin-card full-width">
                                    <h3>ğŸ“‹ Daftar Kegiatan</h3>
                                    <div class="events-table-container" id="eventsTableContainer">
                                        <table class="events-table">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Nama</th>
                                                    <th>Poin</th>
                                                    <th>Status</th>
                                                    <th>Peserta</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="eventsTableBody">
                                                <tr>
                                                    <td colspan="5" class="empty-state">Memuat data...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Buat Kegiatan -->
                                <div class="admin-card">
                                    <h3>â• Buat Kegiatan Baru</h3>
                                    <form id="createActivityForm" class="form">
                                        <div class="form-group">
                                            <label for="activityName">Nama Kegiatan</label>
                                            <input type="text" id="activityName" placeholder="Contoh: Seminar AI"
                                                required>
                                        </div>
                                        <div class="form-group">
                                            <label for="pointReward">Poin Reward</label>
                                            <input type="number" id="pointReward" placeholder="100" min="1" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Buat Kegiatan</button>
                                    </form>
                                </div>

                                <!-- Berikan Poin -->
                                <div class="admin-card">
                                    <h3>ğŸ’° Berikan Poin ke Mahasiswa</h3>
                                    <form id="rewardStudentForm" class="form">
                                        <div class="form-group">
                                            <label for="rewardEventSelect">Pilih Kegiatan</label>
                                            <select id="rewardEventSelect" required>
                                                <option value="">-- Pilih Kegiatan --</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="rewardStudentSelect">Pilih Mahasiswa</label>
                                            <select id="rewardStudentSelect" required>
                                                <option value="">-- Pilih kegiatan terlebih dahulu --</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Kirim Poin</button>
                                    </form>
                                </div>

                                <!-- Terbitkan Sertifikat -->
                                <div class="admin-card">
                                    <h3>ğŸ–ï¸ Terbitkan Sertifikat NFT</h3>
                                    <form id="mintCertificateForm" class="form">
                                        <div class="form-group">
                                            <label for="certEventSelect">Pilih Kegiatan</label>
                                            <select id="certEventSelect" required>
                                                <option value="">-- Pilih Kegiatan --</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="certStudentSelect">Pilih Mahasiswa (yang sudah hadir)</label>
                                            <select id="certStudentSelect" required>
                                                <option value="">-- Pilih kegiatan terlebih dahulu --</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="certUri">IPFS URI (Metadata)</label>
                                            <input type="text" id="certUri" placeholder="ipfs://..." required>
                                        </div>
                                        <div class="cert-preview-section" id="certPreviewSection"
                                            style="display: none;">
                                            <label>Preview Sertifikat</label>
                                            <div class="cert-preview-container">
                                                <img id="certPreviewImage" src="" alt="Certificate Preview">
                                                <div class="cert-preview-info" id="certPreviewInfo"></div>
                                            </div>
                                        </div>
                                        <div class="form-actions">
                                            <button type="button" class="btn btn-secondary"
                                                id="previewCertBtn">Preview</button>
                                            <button type="submit" class="btn btn-primary">Terbitkan Sertifikat</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Pengajuan Tab -->
                        <div class="admin-tab-content" id="adminPengajuan">
                            <div class="page-header">
                                <h3>ğŸ“© Pengajuan Sertifikat dari Mahasiswa</h3>
                                <p>Review dan approve/tolak pengajuan sertifikat</p>
                            </div>
                            <div class="submissions-grid" id="submissionsGrid">
                                <div class="empty-state">
                                    <p>Tidak ada pengajuan sertifikat yang pending.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Semua Sertifikat Tab -->
                        <div class="admin-tab-content" id="adminSertifikat">
                            <div class="page-header centered">
                                <h3>ğŸ–ï¸ Semua Sertifikat yang Diterbitkan</h3>
                                <p>Galeri sertifikat NFT yang sudah di-mint</p>
                            </div>
                            <div class="certificates-gallery large" id="allCertificatesGallery">
                                <div class="empty-state">
                                    <p>Belum ada sertifikat yang diterbitkan.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Notification -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal" id="modal">
            <div class="modal-header">
                <h3 id="modalTitle">Modal Title</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.6.4/ethers.umd.min.js"></script>
    <script src="js/contracts.js"></script>
    <script src="js/web3-utils.js"></script>
    <script src="js/app.js"></script>
</body>

</html>